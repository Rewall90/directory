generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["postgresqlExtensions"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Course {
  id                     String              @id @default(uuid())
  slug                   String              @unique
  name                   String
  formerName             String?             @map("former_name")
  addressStreet          String              @map("address_street")
  addressArea            String?             @map("address_area")
  postalCode             String              @map("postal_code")
  city                   String
  municipality           String
  region                 String
  country                String              @default("Norway")
  latitude               Float?              @map("lat")
  longitude              Float?              @map("lng")
  coordinateAccuracy     String?             @map("coordinate_accuracy")
  holes                  Int
  holesPlayed            Int                 @map("holes_played")
  par                    Int?
  parPerRound            Int?                @map("par_per_round")
  par3Count              Int?                @map("par3_count")
  par4Count              Int?                @map("par4_count")
  par5Count              Int?                @map("par5_count")
  lengthYards            Int?                @map("length_yards")
  lengthMeters           Int?                @map("length_meters")
  lengthNote             String?             @map("length_note")
  terrain                String?
  courseType             String?             @map("course_type")
  designer               String?
  yearBuilt              Int?                @map("year_built")
  yearRedesigned         Int?                @map("year_redesigned")
  description            String?
  waterHazards           Boolean?            @map("water_hazards")
  signatureHole          String?             @map("signature_hole")
  scenicHole             String?             @map("scenic_hole")
  phone                  String?
  email                  String?
  emailAlt               String?             @map("email_alt")
  website                String?
  facebook               String?
  instagram              String?
  golfbox                Boolean?            @default(false)
  seasonStart            String?             @map("season_start")
  seasonEnd              String?             @map("season_end")
  visitorsWelcome        Boolean?            @map("visitors_welcome")
  walkingAllowed         Boolean?            @map("walking_allowed")
  winterUse              String?             @map("winter_use")
  mountainViews          Boolean?            @map("mountain_views")
  viewDescription        String?             @map("view_description")
  nearbyCity             String?             @map("nearby_city")
  distanceFromCenter     String?             @map("distance_from_center")
  courseCompany          String?             @map("course_company")
  clubOrganization       String?             @map("club_organization")
  scrapedAt              DateTime            @map("scraped_at")
  dataQuality            String?             @map("data_quality")
  websiteQuality         String?             @map("website_quality")
  completenessPercentage Int?                @map("completeness_percentage")
  pagesScraped           Int?                @map("pages_scraped")
  createdAt              DateTime            @default(now()) @map("created_at")
  updatedAt              DateTime            @updatedAt @map("updated_at")
  weatherCondition       String?             @map("weather_condition")
  weatherFeelsLike       Float?              @map("weather_feels_like")
  weatherHumidity        Int?                @map("weather_humidity")
  weatherIcon            String?             @map("weather_icon")
  weatherPrecipChance    Int?                @map("weather_precip_chance")
  weatherTemp            Float?              @map("weather_temp")
  weatherUpdatedAt       DateTime?           @map("weather_updated_at")
  weatherUvIndex         Int?                @map("weather_uv_index")
  weatherVisibility      Float?              @map("weather_visibility")
  weatherWindDirection   Int?                @map("weather_wind_direction")
  weatherWindSpeed       Float?              @map("weather_wind_speed")
  additionalFeatures     AdditionalFeature[]
  courseRatings          CourseRating[]
  courseRecords          CourseRecord[]
  facilities             Facility?
  membershipPricing      MembershipPricing[]
  nearbyCourses          NearbyCourse[]      @relation("CourseToNearby")
  nearbyOf               NearbyCourse[]      @relation("NearbyToCourse")
  phoneNumbers           PhoneNumber[]
  pricing                Pricing[]
  ratings                Rating[]
  sources                Source[]
  sponsors               Sponsor[]

  @@index([region])
  @@index([slug])
  @@index([city])
  @@index([holes])
  @@index([par])
  @@index([latitude])
  @@index([longitude])
  @@map("courses")
}

model Facility {
  id                 String   @id @default(uuid())
  courseId           String   @unique @map("course_id")
  drivingRange       Boolean? @map("driving_range")
  drivingRangeLength Int?     @map("driving_range_length")
  drivingRangeNotes  String?  @map("driving_range_notes")
  puttingGreen       Boolean? @map("putting_green")
  chippingArea       Boolean? @map("chipping_area")
  practiceBunker     Boolean? @map("practice_bunker")
  clubhouse          Boolean?
  clubhouseName      String?  @map("clubhouse_name")
  proShop            Boolean? @map("pro_shop")
  restaurant         Boolean?
  restaurantName     String?  @map("restaurant_name")
  clubRental         Boolean? @map("club_rental")
  clubRentalNotes    String?  @map("club_rental_notes")
  cartRental         Boolean? @map("cart_rental")
  pullCartRental     Boolean? @map("pull_cart_rental")
  golfLessons        Boolean? @map("golf_lessons")
  teachingPro        Boolean? @map("teaching_pro")
  clubFitting        Boolean? @map("club_fitting")
  lockerRooms        Boolean? @map("locker_rooms")
  showers            Boolean?
  lockerRental       Boolean? @map("locker_rental")
  conferenceRoom     Boolean? @map("conference_room")
  eventVenue         Boolean? @map("event_venue")
  eventCapacity      Int?     @map("event_capacity")
  simulator          Boolean?
  simulatorType      String?  @map("simulator_type")
  simulatorCourses   String?  @map("simulator_courses")
  simulatorNotes     String?  @map("simulator_notes")
  bunkers            Int?
  footgolf           Boolean?
  footgolfHoles      Int?     @map("footgolf_holes")
  footgolfPar        Int?     @map("footgolf_par")
  tennis             Boolean?
  tennisCourts       Int?     @map("tennis_courts")
  discGolf           Boolean? @map("disc_golf")
  discGolfStandard   String?  @map("disc_golf_standard")
  createdAt          DateTime @default(now()) @map("created_at")
  updatedAt          DateTime @updatedAt @map("updated_at")
  course             Course   @relation(fields: [courseId], references: [id], onDelete: Cascade)

  @@map("facilities")
}

model Pricing {
  id                   String   @id @default(uuid())
  courseId             String   @map("course_id")
  year                 Int
  currency             String   @default("NOK")
  greenFeeDaily        Int?     @map("green_fee_daily")
  greenFeeWeekday      Int?     @map("green_fee_weekday")
  greenFeeWeekend      Int?     @map("green_fee_weekend")
  greenFeeSenior       Int?     @map("green_fee_senior")
  greenFeeJunior       Int?     @map("green_fee_junior")
  greenFeeDescription  String?  @map("green_fee_description")
  cartRental           Int?     @map("cart_rental")
  pullCartRental       Int?     @map("pull_cart_rental")
  clubRental           Int?     @map("club_rental")
  specialOfferPrice    Int?     @map("special_offer_price")
  specialOfferIncludes String?  @map("special_offer_includes")
  freeTrial            Boolean? @map("free_trial")
  notes                String?
  createdAt            DateTime @default(now()) @map("created_at")
  updatedAt            DateTime @updatedAt @map("updated_at")
  course               Course   @relation(fields: [courseId], references: [id], onDelete: Cascade)

  @@unique([courseId, year])
  @@index([year])
  @@map("pricing")
}

model MembershipPricing {
  id          String   @id @default(uuid())
  courseId    String   @map("course_id")
  year        Int
  category    String
  price       Int
  description String?
  ageRange    String?  @map("age_range")
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")
  course      Course   @relation(fields: [courseId], references: [id], onDelete: Cascade)

  @@unique([courseId, year, category])
  @@index([year])
  @@map("membership_pricing")
}

model Rating {
  id          String   @id @default(uuid())
  courseId    String   @map("course_id")
  source      String
  rating      Float?
  reviewCount Int?     @map("review_count")
  maxRating   Float?   @default(5.0) @map("max_rating")
  url         String?
  likes       Int?
  checkIns    Int?     @map("check_ins")
  scrapedAt   DateTime @map("scraped_at")
  course      Course   @relation(fields: [courseId], references: [id], onDelete: Cascade)

  @@unique([courseId, source])
  @@index([source])
  @@map("ratings")
}

model CourseRating {
  id           String   @id @default(uuid())
  courseId     String   @map("course_id")
  teeColor     String   @map("tee_color")
  teeNumber    Int?     @map("tee_number")
  gender       String
  courseRating Float?   @map("course_rating")
  slopeRating  Int?     @map("slope_rating")
  lengthYards  Int?     @map("length_yards")
  lengthMeters Int?     @map("length_meters")
  par          Int?
  createdAt    DateTime @default(now()) @map("created_at")
  updatedAt    DateTime @updatedAt @map("updated_at")
  course       Course   @relation(fields: [courseId], references: [id], onDelete: Cascade)

  @@unique([courseId, teeColor, gender])
  @@map("course_ratings")
}

model PhoneNumber {
  id          String  @id @default(uuid())
  courseId    String  @map("course_id")
  phoneNumber String  @map("phone_number")
  type        String?
  isPrimary   Boolean @default(false) @map("is_primary")
  course      Course  @relation(fields: [courseId], references: [id], onDelete: Cascade)

  @@index([courseId])
  @@map("phone_numbers")
}

model Source {
  id           String   @id @default(uuid())
  courseId     String   @map("course_id")
  type         String
  url          String?
  dataObtained String[] @map("data_obtained")
  pagesScraped Int?     @map("pages_scraped")
  scrapedAt    DateTime @map("scraped_at")
  course       Course   @relation(fields: [courseId], references: [id], onDelete: Cascade)

  @@index([courseId])
  @@map("sources")
}

model AdditionalFeature {
  id          String  @id @default(uuid())
  courseId    String  @map("course_id")
  feature     String
  description String?
  course      Course  @relation(fields: [courseId], references: [id], onDelete: Cascade)

  @@index([courseId])
  @@map("additional_features")
}

model CourseRecord {
  id         String  @id @default(uuid())
  courseId   String  @map("course_id")
  gender     String
  score      Int
  underPar   Int     @map("under_par")
  playerName String  @map("player_name")
  year       Int
  note       String?
  course     Course  @relation(fields: [courseId], references: [id], onDelete: Cascade)

  @@index([courseId])
  @@map("course_records")
}

model NearbyCourse {
  id             String @id @default(uuid())
  courseId       String @map("course_id")
  nearbyCourseId String @map("nearby_course_id")
  distanceKm     Float? @map("distance_km")
  course         Course @relation("CourseToNearby", fields: [courseId], references: [id], onDelete: Cascade)
  nearbyCourse   Course @relation("NearbyToCourse", fields: [nearbyCourseId], references: [id], onDelete: Cascade)

  @@unique([courseId, nearbyCourseId])
  @@index([courseId])
  @@index([nearbyCourseId])
  @@map("nearby_courses")
}

model Sponsor {
  id         String  @id @default(uuid())
  courseId   String  @map("course_id")
  name       String
  logo       String?
  website    String?
  holeNumber Int?    @map("hole_number")
  course     Course  @relation(fields: [courseId], references: [id], onDelete: Cascade)

  @@index([courseId])
  @@map("sponsors")
}
